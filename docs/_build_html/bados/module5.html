

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Bad Actor Detection &mdash; Introduction to ASM/AWAF Behavioral DoS 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Bad Actor Detection and Request Signatures" href="module6.html" />
    <link rel="prev" title="5. Request Signatures" href="module4.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Introduction to ASM/AWAF Behavioral DoS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="module1.html">2. Base Configuration and Traffic Baseline</a></li>
<li class="toctree-l1"><a class="reference internal" href="module2.html">3. Application Security DoS Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="module3.html">4. Stress-Based and Behavioral DoS Profile Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="module4.html">5. Request Signatures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Bad Actor Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="module6.html">7. Bad Actor Detection and Request Signatures</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Introduction to ASM/AWAF Behavioral DoS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>6. Bad Actor Detection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/bados/module5.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bad-actor-detection">
<span id="module5"></span><h1>6. Bad Actor Detection<a class="headerlink" href="#bad-actor-detection" title="Permalink to this headline">¶</a></h1>
<p>In the last module, you used request signature detection to mitigate an application layer DoS attack.  You also saw the Behavioral DoS engine deploy global rate limiting to bring the servers back to health while signatures were being generated, then mitigate targeted attack traffic with the newly generated signature.  In this module, we will leverage Bad Actor Detection to throttle known bad actors.</p>
<ol class="arabic simple">
<li>Navigate to <strong>Security ›› DoS Protection : DoS Profiles</strong> and click the hackazon_bados profile we created earlier.</li>
<li>Click the <strong>Application Security</strong> tab, and then click <strong>Behavioral &amp; Stress-based Detection</strong> button in the Application Security panel.</li>
<li>Click the <strong>Edit</strong> link to the right of the <strong>Behavioral Detection and Mitigation</strong> section, then check the checkbox for <strong>Bad actors behavior detection</strong>, and uncheck the box next to <strong>request signatures detection</strong></li>
<li>Scroll down, and click <strong>Update</strong> button.</li>
<li>From the Xubuntu Jumpbox open another Terminal window.  Then:</li>
</ol>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">f5student@xjumpbox$</span>~ ssh root@10.1.1.245
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>From the SSH session, run the following command:</li>
</ol>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[root@bigipo01:Active:Standalone] config #</span> watch ipidr -l /Common/vs_hackazon_http+/Common/hackazon_bados
</pre></div>
</div>
<p>Initially, because no attack is active, the IP list will be empty.  Keep this command running in one of the Terminal window.  Things are about to change!</p>
</div></blockquote>
<ol class="arabic simple" start="7">
<li>Using the Terminal window on the Xubuntu Jumpbox from previous module, or a new one, re-run the attack script using the following command:</li>
</ol>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">f5student@xjumpbox~$</span> ./AB_DOS.sh

<span class="go">- Select **2** – Attack start - score</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="8">
<li>Using Chromium Browser on the Xubuntu Jumpbox, open another tab to the GUI on bigip01, and navigate to <strong>Security ›› Event Logs ››  DoS ›› Application Events</strong></li>
<li>Almost immediately you should see an attack has started, and Advanced Web Application Firewall has assigned an Attack ID to the event.  You will see something similar to the screenshot below:</li>
</ol>
<blockquote>
<div><a class="reference internal" href="../_images/event-log-bados-start.png"><img alt="event-log-bados-start" src="../_images/event-log-bados-start.png" style="width: 6.59740in; height: 1.03203in;" /></a></div></blockquote>
<ol class="arabic simple" start="10">
<li>From the Terminal window started in step #6, monitor the output of the ipidr command, and the status of the IP greylist.  You should see something similar to the image below:</li>
</ol>
<blockquote>
<div><blockquote>
<div><a class="reference internal" href="../_images/ipidr-output.png"><img alt="ipidr-output" src="../_images/ipidr-output.png" style="width: 5.59740in; height: 4.33203in;" /></a></div></blockquote>
<ol class="arabic simple">
<li><strong>IP</strong>: IP address that is member of the greylist</li>
<li><strong>Rate</strong>: Probability of drop for an ingress packet.  Higher number equals higher drop rate at the TCP layer.  As drop rate goes up, retransmit rates increase, and subsequently TCP window sizes adjust closer to zero.  Also, note this behavior will be different if the client IP is learned through a layer 7 header.  If so, the behavior will be an HTTP rate limit versus TCP based mitigations.</li>
<li><strong>Prod</strong>: Number of stat producers.  In this environment, this should always be 1.</li>
<li><strong>Tout</strong>: Time-out/TTL. Prior to releasing an IP address from the greylist, Advanced Web Application Firewall will quarantine the IP address for a period of time.  During this time, TCP slowdown methods will discontinue, and HTTP rate limiting will take over.  If during the quarantine period, the IP address triggers more attack traffic, the IP will be removed from quarantine and placed back in greylist.  Quarantined IP addresses are visible in the DoS Dashboard/Analytics views in the Mitigation panel.</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="11">
<li>With the attack script still running, examine the output of the baseline script.  You should be getting HTTP 200 OK responses, and response time should be inline with pre-attack response times.  Also, verify you can use browse to <a class="reference external" href="http://hackazon.f5demo.com">http://hackazon.f5demo.com</a> without issue.</li>
<li>In the window where you are running the attack script, enter <strong>CTRL-C</strong>, they type <strong>4</strong> to kill the attack script cleanly.</li>
<li>Leave baseline_menu.sh script running.</li>
</ol>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="module6.html" class="btn btn-neutral float-right" title="7. Bad Actor Detection and Request Signatures" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="module4.html" class="btn btn-neutral" title="5. Request Signatures" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michael Everett.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>